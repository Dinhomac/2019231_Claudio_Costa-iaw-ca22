<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Spirits Counter </title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.3.1/litera/bootstrap.min.css">
</head>

<body>

    <div class="container p-5">
        <div class="row">
            <div class="col-md-4 offset-md-4">
                <form action="https://3000-dinhomac-2019231claudio-joqp3o0c9k4.ws-eu45.gitpod.io/add" method="POST" class="card card-body">
                    <div class="form-group">
                        <input type="text" name="spirit" placeholder="Insert a new Spirit" class="form-control" autofocus>
                    </div>
                    <div class="form-group">
                        <input type="text" name="description" placeholder="Write A Description" class="form-control">
                    </div>
                    <div class="form-group">
                        <input type="number" name="price" placeholder="insert price" class="form-control">
                    </div>
                    <button class="btn btn-primary">
                        
                    </button>
                </form>

                <% spirits.forEach(function (spirit) { %>
                    <div class="card card-body mt-2">
                        <div id="spiritId"><%= spirit._id %></div>
                        <h5><%= spirit.spirit %> -  </h5>
                        <p><%= spirit.description %></p>
                        <p><%= spirit.price %></p>

                            <h2>
                                <strong>
                                    <a class="btn btn-primary" href="https://3000-dinhomac-2019231claudio-joqp3o0c9k4.ws-eu45.gitpod.io/?key=123" id="<%= spirit._id %>" onclick="deletespirit(this.id);">
                                        X
                                    </a>
                                </strong>
                            </h2>
                    </div>
                <% }) %>
            </div>
        </div>
    </div>
    <script>
        //Have to use fetch as put and delete not supported in modern browsers in html
        function deletespirit (spiritId) {
            console.log('spirit deleted', spiritId);

            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/json");

            var raw = JSON.stringify({
              "spiritId": spiritId
            });

            var requestOptions = {
              method: 'POST',
              headers: myHeaders,
              body: raw,
              redirect: 'follow'
            };

            fetch("https://3000-dinhomac-2019231claudio-joqp3o0c9k4.ws-eu45.gitpod.io/delete", requestOptions)
              .then(response => response.text())
              .then(result => console.log(result))
              .catch(error => console.log('error', error));
        }
    </script>

</body>

</html>